<!DOCTYPE html>
<html lang="en-us"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
   <meta name="description" content="Link to challenge: The Greenholt Phish
The task A Sales Executive at Greenholt PLC received an email that he didn&rsquo;t expect to receive from a customer. He claims that the customer never uses generic greetings such as &ldquo;Good day&rdquo; and didn&rsquo;t expect any amount of money to be transferred to his account. The email also contains an attachment that he never requested. He forwarded the email to the SOC (Security Operations Center) department for further investigation.">  

  <title>
    
      CTF writeup: The Greenholt Phish (TryHackMe)
    
  </title>


  <link rel="shortcut icon" type="image/x-icon" href="/" />
  
  
  
  <link rel="stylesheet" href="/css/main.3261f53b048c2c040ff46432afee3d5a46197b03f8b24f68f6c0e4db3c6abeb79b10060ff01993277938c20526aa55b2d1ad5607cb4e2902d4d41120d370916a.css" integrity="sha512-MmH1OwSMLAQP9GQyr&#43;49WkYZewP4sk9o9sDk2zxqvrebEAYP8BmTJ3k4wgUmqlWy0a1WB8tOKQLU1BEg03CRag==" />
  
</head>
<body><div class="topnav-container">
    <div class="nav-container">
        <div class="theme-toggle">
            <input type="checkbox" id="ChangeTheme"/>
            <label for="ChangeTheme"> 
                <svg class="moon" id="Moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><polygon points="22 17 22 19 21 19 21 20 20 20 20 21 18 21 18 22 16 22 16 23 10 23 10 22 8 22 8 21 6 21 6 20 5 20 5 19 4 19 4 17 3 17 3 15 2 15 2 9 3 9 3 7 4 7 4 5 5 5 5 4 6 4 6 3 8 3 8 2 10 2 10 1 15 1 15 2 13 2 13 3 11 3 11 4 10 4 10 6 9 6 9 8 8 8 8 12 9 12 9 14 10 14 10 16 11 16 11 17 13 17 13 18 15 18 15 19 19 19 19 18 21 18 21 17 22 17"/></svg>
                <svg class="sun" id="Sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><polygon points="17 10 17 14 16 14 16 15 15 15 15 16 14 16 14 17 10 17 10 16 9 16 9 15 8 15 8 14 7 14 7 10 8 10 8 9 9 9 9 8 10 8 10 7 14 7 14 8 15 8 15 9 16 9 16 10 17 10"/><path d="m21,11v-1h1v-1h1v-2h-3v-1h-2v-2h-1V1h-2v1h-1v1h-1v1h-2v-1h-1v-1h-1v-1h-2v3h-1v2h-2v1H1v2h1v1h1v1h1v2h-1v1h-1v1h-1v2h3v1h2v2h1v3h2v-1h1v-1h1v-1h2v1h1v1h1v1h2v-3h1v-2h2v-1h3v-2h-1v-1h-1v-1h-1v-2h1Zm-3,4h-1v1h-1v1h-1v1h-6v-1h-1v-1h-1v-1h-1v-6h1v-1h1v-1h1v-1h6v1h1v1h1v1h1v6Z"/></svg>
            </label>
        </div>
        <ul id="menu">
            <a href="/">
                home
            </a>
            <a href="/posts/">
                posts
            </a>
            <a href="/tags/">
                tags
            </a>
        </ul>
    </div>
</div>

<script>
var checkbox = document.getElementById("ChangeTheme"); 


if (sessionStorage.getItem("mode") == "dark") {
  darkmode();
} else {
  nodark();
}


checkbox.addEventListener("change", function() {
  
  if (checkbox.checked) {
    darkmode();
  } else {
    nodark();
  }
});


function darkmode() {
  document.body.classList.add("light");
  checkbox.checked = true;
  sessionStorage.setItem("mode", "dark"); 
}


function nodark() {
  document.body.classList.remove("light");
  checkbox.checked = false;
  sessionStorage.setItem("mode", "light"); 
}
</script>
<main class="page-content" aria-label="Content">
            <div class="w">

<article class="post-single">
    <header class="post-header">
    <span class="post-tags">
        
            <a href="http://localhost:1313/tags/ctf/">
                 #ctf</a>&nbsp;
        
            <a href="http://localhost:1313/tags/writeup/">
                 #writeup</a>&nbsp;
        
    </span>


<h1 class="post-title">CTF writeup: The Greenholt Phish (TryHackMe)</h1>
        <p class="post-meta">&lt;span title=&#39;2023-08-16 02:24:38 &#43;0300 EEST&#39;&gt;16.08.2023&lt;/span&gt; :: 4 min read :: ogjojo&nbsp;|&nbsp;<a href="https://github.com/linutti/linutti.com/blob/main/content/posts/ctf-thm-the-greenholt-phish.md" rel="noopener noreferrer" target="_blank">SUGGEST CHANGES</a>

</p>
    </header>
    
        <aside ><div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">table of contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#the-task" aria-label="The task">The task</a></li>
                <li>
                    <a href="#task-1-what-date-was-the-email-received-answer-format-mddyy" aria-label="Task 1: What date was the email received? (answer format: M/DD/YY)">Task 1: What date was the email received? (answer format: M/DD/YY)</a><ul>
                        
                <li>
                    <a href="#a-2020" aria-label="A: */**/2020">A: <em>*/**/2020</em></a></li></ul>
                </li>
                <li>
                    <a href="#q2-who-is-the-email-from" aria-label="Q2: Who is the email from?">Q2: Who is the email from?</a><ul>
                        
                <li>
                    <a href="#a-mr-j-j" aria-label="A: Mr. J*** J***">A: <em>Mr. J*** J***</em></a></li></ul>
                </li>
                <li>
                    <a href="#q3-what-is-his-email-address" aria-label="Q3: What is his email address?">Q3: What is his email address?</a><ul>
                        
                <li>
                    <a href="#a-infomutacom" aria-label="A: info@muta***.com">A: <em>info@muta***.com</em></a></li></ul>
                </li>
                <li>
                    <a href="#q4-what-email-address-will-receive-a-reply-to-this-email" aria-label="Q4: What email address will receive a reply to this email?">Q4: What email address will receive a reply to this email?</a><ul>
                        
                <li>
                    <a href="#a-infomutamailcom" aria-label="A: info.muta***@mail.com">A: <em>info.muta***@mail.com</em></a></li></ul>
                </li>
                <li>
                    <a href="#q5-what-is-the-originating-ip" aria-label="Q5: What is the Originating IP?">Q5: What is the Originating IP?</a><ul>
                        
                <li>
                    <a href="#a-192" aria-label="A: &amp;ldquo;192.***.**.***&amp;rdquo;">A: <em>&ldquo;192.***.**.***&rdquo;</em></a></li></ul>
                </li>
                <li>
                    <a href="#q6-who-is-the-owner-of-the-originating-ip-do-not-include-the--in-your-answer" aria-label="Q6: Who is the owner of the Originating IP? (Do not include the &amp;ldquo;.&amp;rdquo; in your answer.)">Q6: Who is the owner of the Originating IP? (Do not include the &ldquo;.&rdquo; in your answer.)</a><ul>
                        
                <li>
                    <a href="#a-host-" aria-label="A: Host*** ***">A: <em>Host*** ***</em></a></li></ul>
                </li>
                <li>
                    <a href="#q7-what-is-the-spf-record-for-the-return-path-domain" aria-label="Q7: What is the SPF record for the Return-Path domain?">Q7: What is the SPF record for the Return-Path domain?</a><ul>
                        
                <li>
                    <a href="#a-v-includecom--all" aria-label="A: v=*** include:***.***.***.com -all">A: <em>v=*** include:***.***.***.com -all</em></a></li></ul>
                </li>
                <li>
                    <a href="#q8-what-is-the-dmarc-record-for-the-return-path-domain" aria-label="Q8: What is the DMARC record for the Return-Path domain?">Q8: What is the DMARC record for the Return-Path domain?</a><ul>
                        
                <li>
                    <a href="#a-v-p-fo1" aria-label="A: v=***; p=***; fo=1">A: <em>v=***; p=***; fo=1</em></a></li></ul>
                </li>
                <li>
                    <a href="#q9-what-is-the-name-of-the-attachment" aria-label="Q9: What is the name of the attachment?">Q9: What is the name of the attachment?</a><ul>
                        
                <li>
                    <a href="#a-swt____pdf__cab" aria-label="A: SWT_***_PDF.CAB">A: <em>SWT_***_<strong>PDF</strong>.CAB</em></a></li></ul>
                </li>
                <li>
                    <a href="#q10-what-is-the-sha256-hash-of-the-file-attachment" aria-label="Q10: What is the SHA256 hash of the file attachment?">Q10: What is the SHA256 hash of the file attachment?</a><ul>
                        
                <li>
                    <a href="#a-long-string-of-random-letters-and-numbers-2a91c533615a9" aria-label="A: long string of random letters and numbers&amp;hellip; 2a91c533615a9***">A: long string of random letters and numbers&hellip; <em>2a91c533615a9***</em></a></li></ul>
                </li>
                <li>
                    <a href="#q11-what-is-the-attachments-file-size-dont-forget-to-add-kb-to-your-answer-num-kb" aria-label="Q11: What is the attachments file size? (Don&amp;rsquo;t forget to add &amp;ldquo;KB&amp;rdquo; to your answer, NUM KB)">Q11: What is the attachments file size? (Don&rsquo;t forget to add &ldquo;KB&rdquo; to your answer, NUM KB)</a><ul>
                        
                <li>
                    <a href="#a-26-kb" aria-label="A: ***.26 KB">A: <em>***.26 KB</em></a></li></ul>
                </li>
                <li>
                    <a href="#q12-what-is-the-actual-file-extension-of-the-attachment" aria-label="Q12: What is the actual file extension of the attachment?">Q12: What is the actual file extension of the attachment?</a><ul>
                        
                <li>
                    <a href="#a-a" aria-label="A: *A*">A: <em>*A*</em></a></li></ul>
                </li>
                <li>
                    <a href="#footnotes" aria-label="Footnotes">Footnotes</a>
                </li>
            </ul>
        </div>
    </details>
</div>

        </aside>
    <p>Link to challenge: <a href="https://tryhackme.com/room/phishingemails5fgjlzxc">The Greenholt Phish</a></p>
<h2 id="the-task">The task<a hidden class="anchor" aria-hidden="true" href="#the-task">#</a></h2>
<blockquote>
<p>A Sales Executive at Greenholt PLC received an email that he didn&rsquo;t expect to receive from a customer. He claims that the customer never uses generic greetings such as &ldquo;Good day&rdquo; and didn&rsquo;t expect any amount of money to be transferred to his account. The email also contains an attachment that he never requested. He forwarded the email to the SOC (Security Operations Center) department for further investigation.</p>
<p>Investigate the email sample to determine if it is legitimate.</p>
</blockquote>
<p>Let&rsquo;s launch the machine and dive right in!</p>
<h2 id="task-1-what-date-was-the-email-received-answer-format-mddyy">Task 1: What date was the email received? (answer format: M/DD/YY)<a hidden class="anchor" aria-hidden="true" href="#task-1-what-date-was-the-email-received-answer-format-mddyy">#</a></h2>
<p>First, let&rsquo;s fire up a termianl and <code>cd</code> our way into <code>/home/ubuntu/Desktop</code>. Now let&rsquo;s run <code>head challenge.eml</code> to get the first 10 lines of the file wich should contain the date.</p>
<p>In fact, it does!</p>
<h3 id="a-2020">A: <em>*/**/2020</em><a hidden class="anchor" aria-hidden="true" href="#a-2020">#</a></h3>
<h2 id="q2-who-is-the-email-from">Q2: Who is the email from?<a hidden class="anchor" aria-hidden="true" href="#q2-who-is-the-email-from">#</a></h2>
<p>By running <code>grep -i &quot;from&quot; challenge.eml</code> we can get the relevant message headers. Our answer can be found on line 7.</p>
<h3 id="a-mr-j-j">A: <em>Mr. J*** J***</em><a hidden class="anchor" aria-hidden="true" href="#a-mr-j-j">#</a></h3>
<h2 id="q3-what-is-his-email-address">Q3: What is his email address?<a hidden class="anchor" aria-hidden="true" href="#q3-what-is-his-email-address">#</a></h2>
<p>Answer can be found on the same line as the answer to the previous question.</p>
<h3 id="a-infomutacom">A: <em>info@muta***.com</em><a hidden class="anchor" aria-hidden="true" href="#a-infomutacom">#</a></h3>
<h2 id="q4-what-email-address-will-receive-a-reply-to-this-email">Q4: What email address will receive a reply to this email?<a hidden class="anchor" aria-hidden="true" href="#q4-what-email-address-will-receive-a-reply-to-this-email">#</a></h2>
<p>Run command <code>grep -i &quot;reply-to&quot; challenge.eml</code>. Boom!</p>
<h3 id="a-infomutamailcom">A: <em>info.muta***@mail.com</em><a hidden class="anchor" aria-hidden="true" href="#a-infomutamailcom">#</a></h3>
<h2 id="q5-what-is-the-originating-ip">Q5: What is the Originating IP?<a hidden class="anchor" aria-hidden="true" href="#q5-what-is-the-originating-ip">#</a></h2>
<p>Answer can also be found in the same output as question 2 and 3, but on line 5 this time. Rerun the command <code>grep -i &quot;from&quot; challenge.eml</code> to get the output.</p>
<h3 id="a-192">A: <em>&ldquo;192.***.**.***&rdquo;</em><a hidden class="anchor" aria-hidden="true" href="#a-192">#</a></h3>
<h2 id="q6-who-is-the-owner-of-the-originating-ip-do-not-include-the--in-your-answer">Q6: Who is the owner of the Originating IP? (Do not include the &ldquo;.&rdquo; in your answer.)<a hidden class="anchor" aria-hidden="true" href="#q6-who-is-the-owner-of-the-originating-ip-do-not-include-the--in-your-answer">#</a></h2>
<p>To get the answer I did a lookup on the IP address. A big hint can be seen on the same line as the answer to the previous question.</p>
<p>The answer is the name of the company, not the URL. You naughty naughty trying to throw me off with the hint in the question saying not to include the &ldquo;.&rdquo;!</p>
<style>
  #small-pic {width:300px}
</style>
<img id="small-pic" src="/gifs/you-naughty-naughty.gif">
<h3 id="a-host-">A: <em>Host*** ***</em><a hidden class="anchor" aria-hidden="true" href="#a-host-">#</a></h3>
<h2 id="q7-what-is-the-spf-record-for-the-return-path-domain">Q7: What is the SPF record for the Return-Path domain?<a hidden class="anchor" aria-hidden="true" href="#q7-what-is-the-spf-record-for-the-return-path-domain">#</a></h2>
<p>First we need the domain. Run <code>grep &quot;Return-Path&quot; challenge.eml</code> and grab the domain name. Now navigate on your machine to a website that lets you do an SPF lookup (I used MXToolBox). Search for the domain and you should get the answer.</p>
<h3 id="a-v-includecom--all">A: <em>v=*** include:***.***.***.com -all</em><a hidden class="anchor" aria-hidden="true" href="#a-v-includecom--all">#</a></h3>
<h2 id="q8-what-is-the-dmarc-record-for-the-return-path-domain">Q8: What is the DMARC record for the Return-Path domain?<a hidden class="anchor" aria-hidden="true" href="#q8-what-is-the-dmarc-record-for-the-return-path-domain">#</a></h2>
<p>If you&rsquo;re using MXToolBox like me, then navigate over to &ldquo;DMARC&rdquo; using the top navbar and search for the same domain.</p>
<h3 id="a-v-p-fo1">A: <em>v=***; p=***; fo=1</em><a hidden class="anchor" aria-hidden="true" href="#a-v-p-fo1">#</a></h3>
<h2 id="q9-what-is-the-name-of-the-attachment">Q9: What is the name of the attachment?<a hidden class="anchor" aria-hidden="true" href="#q9-what-is-the-name-of-the-attachment">#</a></h2>
<p>Let&rsquo;s get back into the vm and run some more <code>grep</code> commands!</p>
<p>To get the name of the attachment, simply run <code>grep &quot;attachment&quot; challenge.eml</code>.</p>
<h3 id="a-swt____pdf__cab">A: <em>SWT_***_<strong>PDF</strong>.CAB</em><a hidden class="anchor" aria-hidden="true" href="#a-swt____pdf__cab">#</a></h3>
<h2 id="q10-what-is-the-sha256-hash-of-the-file-attachment">Q10: What is the SHA256 hash of the file attachment?<a hidden class="anchor" aria-hidden="true" href="#q10-what-is-the-sha256-hash-of-the-file-attachment">#</a></h2>
<p>We could do this the easy way - open up the <code>.eml</code> file in ThunderBird, save the attachment, run <code>sha256sum &lt;attachment&gt;</code>. But what fun would that be? No, I want to challenge myself and do this throught the terminal. Let&rsquo;s go!</p>
<p>&gt; <em>does research</em></p>
<p>&gt; <em>realizes that tools needed are not installed</em></p>
<p>&gt; <em>*vm has no internet connection*</em></p>
<p>&gt; <em>proceeds to accept defeat</em></p>
<p>Ok, we&rsquo;re gonna do it the easy way&hellip;</p>
<h3 id="a-long-string-of-random-letters-and-numbers-2a91c533615a9">A: long string of random letters and numbers&hellip; <em>2a91c533615a9***</em><a hidden class="anchor" aria-hidden="true" href="#a-long-string-of-random-letters-and-numbers-2a91c533615a9">#</a></h3>
<h2 id="q11-what-is-the-attachments-file-size-dont-forget-to-add-kb-to-your-answer-num-kb">Q11: What is the attachments file size? (Don&rsquo;t forget to add &ldquo;KB&rdquo; to your answer, NUM KB)<a hidden class="anchor" aria-hidden="true" href="#q11-what-is-the-attachments-file-size-dont-forget-to-add-kb-to-your-answer-num-kb">#</a></h2>
<p>This one threw me for a loop. I was trying to get the file size using the <code>stat</code> command and converting the output from bytes to KB. Wasn&rsquo;t working&hellip;</p>
<p>But then I looked at the hint and it says you&rsquo;re not supposed to do that. Instead, you&rsquo;re supposed to find the file size using the hash and OSINT.</p>
<p>Well, in that case, let&rsquo;s copy the sha256 hash we just generated and navigate over to VirusTotal. Let&rsquo;s click the &ldquo;search&rdquo; tab and paste in the hash.</p>
<p><img src="/pics/ctf-thm-the-greenholt-phish/00.webp" alt="virustotal-file-size"></p>
<h3 id="a-26-kb">A: <em>***.26 KB</em><a hidden class="anchor" aria-hidden="true" href="#a-26-kb">#</a></h3>
<p>NOTE: Added a comment about this at the end of this post not to spoil the answer at this point.</p>
<h2 id="q12-what-is-the-actual-file-extension-of-the-attachment">Q12: What is the actual file extension of the attachment?<a hidden class="anchor" aria-hidden="true" href="#q12-what-is-the-actual-file-extension-of-the-attachment">#</a></h2>
<p>The answer can be seen on the same page on VirusTotal, but we can also navigate over to the &ldquo;Details&rdquo; tab to get a better idea of what the file does.</p>
<p><img src="/pics/ctf-thm-the-greenholt-phish/01.webp" alt="virustotal-details-file-type"></p>
<h3 id="a-a">A: <em>*A*</em><a hidden class="anchor" aria-hidden="true" href="#a-a">#</a></h3>
<hr>
<p>And there we have it! Thank you for reading my writeup of this CTF. Have a nice day! :)</p>
<hr>
<h2 id="footnotes">Footnotes<a hidden class="anchor" aria-hidden="true" href="#footnotes">#</a></h2>
<p>Spoiler alert!</p>
<p>Comment:
I feel like question 11 is somewhat misleading asking for the answer in KB, when the correct format seems to be KiB. In my case, I read &ldquo;KB&rdquo; as being a decimal number (power of 10) and KiB as binary (power of 2).</p>
<p><code>409868 bytes / 1000 = 409.868 kilobytes (decimal KB)</code> while <code>409868 bytes / 1024 = 400.261 kibibytes (binary KiB)</code>. The value in KiB is correct but VirusTotal does also list the value as KB.¯\_(°‿°)_/¯</p>
<p>Oh well, this kind of confusion seems to be widespread and is a rabbithole for another time. You can read more about it on <a href="https://en.wikipedia.org/wiki/Byte#Multiple-byte_units">Wikipedia</a>.</p>
<p>Just something to keep in mind!</p>


</article>
<footer class="post-footer">
    <span class="post-tags">
        
            <a href="http://localhost:1313/tags/ctf/">
                 #ctf</a>&nbsp;
        
            <a href="http://localhost:1313/tags/writeup/">
                 #writeup</a>&nbsp;
        
    </span>


</footer>

            </div>
        </main>
    </body>
</html>
